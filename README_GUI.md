# Pineapple OFC GUI 使用指南

## 概述
`pineapple_ofc_gui.py` 是一個基於 Streamlit 的完整圖形界面應用，提供了 Pineapple OFC（鳳梨開放式中國撲克）遊戲的可視化界面和 AI 輔助功能。

## 功能特點

### 1. 牌桌可視化
- 清晰顯示玩家的三道牌（前墩、中墩、後墩）
- 視覺化顯示當前抽到的牌
- 棄牌堆顯示
- 牌型強度實時更新

### 2. 點選式交互
- 隨機發牌功能（初始5張）
- 手動選擇牌的擺放位置
- 街道抽牌（每次3張，擺2棄1）
- 支持撤銷和重新開始

### 3. AI 建議系統
- 基於 MCTS（蒙特卡洛樹搜索）的最佳擺放建議
- 顯示預期分數和勝率
- 可選擇採用或忽略 AI 建議
- 支持不同模擬次數設置（1k-100k）

### 4. 統計面板
- 當前手牌強度評估
- Fantasy Land 進入機會提示
- 犯規風險警告
- AI 計算性能統計
- 緩存命中率顯示

### 5. 遊戲控制
- 新遊戲開始
- 遊戲進度保存/載入
- 可調整的 AI 設置
- 鬼牌開關選項

## 安裝要求

```bash
# 安裝必要的 Python 包
pip install streamlit
pip install numpy
pip install pandas
```

## 運行方法

```bash
# 在項目目錄下運行
streamlit run pineapple_ofc_gui.py
```

應用將在默認瀏覽器中打開，通常地址為 `http://localhost:8501`

## 使用流程

### 1. 開始新遊戲
- 點擊側邊欄的「🎮 新遊戲」按鈕
- 點擊「🎲 發初始5張牌」獲取起始手牌

### 2. 初始擺放（第0街）
**使用 AI 建議：**
- 點擊「🤖 獲取 AI 建議」
- 查看 AI 推薦的擺放方案和預期分數
- 點擊「✅ 採用 AI 建議」自動擺放

**手動擺放：**
- 從下拉菜單選擇要擺放的牌
- 選擇目標位置（前墩/中墩/後墩）
- 點擊「放置牌」確認擺放
- 重複直到5張牌全部擺放完成

### 3. 抽牌階段（第1-4街）
- 點擊「🎲 抽第X街 (3張牌)」抽取3張新牌
- 選擇2張牌擺放，1張牌棄掉
- 可以使用 AI 建議或手動選擇
- 重複直到所有街道完成

### 4. 遊戲結束
- 系統自動判斷是否犯規
- 顯示最終牌型和得分
- 如果前墩達到 QQ+，恭喜進入 Fantasy Land！

## 設置選項

### MCTS 模擬次數
- 1,000 次：快速響應，適合初學者
- 10,000 次：平衡速度和質量（默認）
- 100,000 次：最高質量，需要更多計算時間

### 鬼牌設置
- 開啟：包含2張鬼牌，增加遊戲變化
- 關閉：標準52張牌

## 界面說明

### 左側欄（遊戲控制）
- 當前街道的操作按鈕
- AI 建議顯示
- 手動擺放控制

### 中間區域（牌桌）
- 前墩（3張牌）：需要較強牌型才能進入 Fantasy Land
- 中墩（5張牌）：需要比前墩強
- 後墩（5張牌）：需要最強，否則犯規
- 棄牌堆：顯示已棄掉的牌

### 右側欄（統計面板）
- 當前牌型強度
- 合法性檢查
- AI 性能統計
- 緩存效率

### 側邊欄（設置）
- 遊戲控制按鈕
- AI 參數調整
- 存檔/讀檔功能

## 技術特點

- **並行計算**：利用多核 CPU 加速 MCTS 計算
- **智能剪枝**：減少不必要的搜索分支
- **緩存優化**：記憶已計算的局面，提高效率
- **響應式設計**：適應不同屏幕尺寸

## 故障排除

### 應用運行緩慢
- 降低 MCTS 模擬次數
- 檢查 CPU 使用率
- 重啟應用

### 無法看到牌的圖案
- 確保瀏覽器支持 Unicode 字符
- 嘗試不同的瀏覽器

### AI 建議不合理
- 增加模擬次數
- 檢查是否正確識別牌型
- 確認遊戲規則理解正確

## 開發說明

核心文件：
- `pineapple_ofc_gui.py`：Streamlit GUI 應用
- `ofc_solver_optimized.py`：優化的求解器引擎
- `ofc_solver_joker.py`：鬼牌處理邏輯
- `ofc_solver_street.py`：街道管理邏輯

## 未來改進

1. 添加多人對戰模式
2. 實現對手 AI
3. 增加歷史記錄分析
4. 優化移動端體驗
5. 添加教學模式